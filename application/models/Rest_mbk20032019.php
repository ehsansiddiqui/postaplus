<?phpclass rest_m extends CI_Model	{	var $user = 'user';	public	function __construct()		{		parent::__construct();		$this->load->database();		}	public	function check_user($username, $password)		{		$sql = "SELECT * FROM user U  WHERE  U.phone_number = '$username' AND U.password = '$password' AND U.status = 1";		$query = $this->db->query($sql);		return $query->row();		}	public	function user_updated($device_id, $device_type, $user_id)		{		$created_date = date('Y-m-d H:i:s', time());		$data = array(			'device_id' => $device_id,			'device_type' => $device_type,			'last_login_date' => $created_date		);		$this->db->where('user_id', $user_id);		$this->db->update('user', $data);		}	public	function add_user($data)		{		$this->db->insert('user', $data);		return $this->db->insert_id();		}	public	function users_check($phone_number)		{		$query = $this->db->get_where('user', array(			'phone_number' => $phone_number		));		return $query->row();		}                                                  public	function get_profiles($user_id)		{    $this->db->select('user_id,phone_number,full_name,email_id,image') ;		$query = $this->db->get_where('user', array(			'user_id' => $user_id		));		return $query->row();		}                       	public	function get_users()		{            		/*$this->db->select('U.user_id,U.phone_number,U.first_name,U.last_name,U.profile_image,U.email_id,U.country,U.gender,U.designation,U.address,U.hef_member_status,U.chapter_id,U.website,U.company,U.state,U.category,C.chapter_name');		$this->db->join('chapter C', 'C.chapter_id= U.chapter_id', 'left');		$this->db->order_by('C.chapter_name', 'ASC');		$this->db->order_by('U.first_name', 'ASC');		$query = $this->db->get_where('user U', array(			'U.status' => 1		));*/                                            $sql = "SELECT    `U`.`user_id`,    `U`.`phone_number`,    `U`.`first_name`,    `U`.`last_name`,    `U`.`profile_image`,    `U`.`email_id`,    `U`.`country`,    `U`.`gender`,    `U`.`designation`,    `U`.`address`,    `U`.`hef_member_status`,    `U`.`chapter_id`,    `U`.`website`,    `U`.`company`,    `U`.`state`,    `U`.`category`,    `C`.`chapter_name`FROM    `user` `U`LEFT JOIN `chapter` `C` ON    `C`.`chapter_id` = `U`.`chapter_id`WHERE    `U`.`status` = 1ORDER BY    COALESCE(`C`.`chapter_name`, 'zz') ASC,    `U`.`first_name` ASC";                                $query = $this->db->query($sql);		return $query->result();                		}	public	function get_advertisement()		{		$this->db->select('advertisement_id,advertisement_name,advertisement_url,advertisement_image');		$query = $this->db->get_where('advertisement', array(			'status' => 1		));		return $query->result();		}	public	function edit_user($data, $user_id)		{		$this->db->where('user_id', $user_id);		$this->db->update('user', $data);		return $user_id;		}	public	function add_posts($data)		{		$this->db->insert('user_posts', $data);		return $this->db->insert_id();		}	public	function get_user_post()		{		$sql = "SELECT UP.*,U.first_name,U.last_name,U.phone_number,U.email_id FROM user_posts UP , user U WHERE UP.user_id = U.user_id";		$query = $this->db->query($sql);		return $query->result();		}	public	function get_chapter()		{		$this->db->order_by('chapter_name', 'ASC');		$query = $this->db->get_where('chapter', array(			'status' => 1		));		return $query->result();		}	public	function get_user_divice_id($user_id)		{		$this->db->select('device_id,device_type');		$query = $this->db->get_where('user', array(			'user_id !=' => $user_id		));		return $query->result();		}	public	function get_articles()		{		// $this->db->select('articles_id,articles_title,articles_desc');		$query = $this->db->get_where('articles', array(			'status' => 1		));		return $query->result();		}	public	function get_message()		{		// $this->db->select('message_id,message_title,message_desc');		$query = $this->db->get_where('message', array(			'status' => 1		));		return $query->result();		}                        public                  function get_search($search_text){                      $sql = "SELECT    U.user_id,    U.phone_number,    U.first_name,    U.last_name,    U.profile_image,    U.email_id,    U.country,    U.gender,    U.designation,    U.address,    U.hef_member_status,    U.chapter_id,    U.website,    U.company,    U.state,    U.category,    C.chapter_nameFROM    `user` ULEFT JOIN `chapter` C ON    (C.chapter_id = U.chapter_id) WHERE ( C.chapter_name LIKE '%$search_text%' OR U.first_name LIKE '%$search_text%' OR U.last_name LIKE '%$search_text%' OR U.company LIKE '%$search_text%' OR U.category LIKE '%$search_text%' OR U.phone_number LIKE '%$search_text%' ) AND U.status = 1";          $query = $this->db->query($sql);    return $query->result();                        }                        public	function get_category()		{		$this->db->order_by('category_name', 'ASC');		$query = $this->db->get_where('category', array(			'status' => 1		));		return $query->result();		}                                        public	function get_printing_type($language_id)		{            		//$this->db->order_by('print_type_name', 'ASC');                $this->db->select('pt.print_type_id,ptd.print_type_name');                $this->db->join('print_type_description ptd','ptd.print_type_id = pt.print_type_id');                $this->db->where('ptd.language_id',$language_id);                $this->db->where('pt.print_type_status',1);		$query = $this->db->get('print_type pt');                                               // print_r($this->db->last_query());die;                		return $query->result();		}                                         public	function get_language()		{				$query = $this->db->get_where('language', array(			'language_status' => 1		));		return $query->result();		}                                                                    public function get_printing($language_id,$print_type_id){                    //    $sql = "SELECT//    P.printing_id,//    P.price,//    A.attributes_id,//    AD.attributes_name,//    PTD.print_type_name//FROM//    printing P,//    print_type PT,//    print_type_description PTD,//    attributes A,//    attributes_description AD//WHERE//    A.attributes_id = AD.attributes_id AND P.print_type_id = PT.print_type_id AND PT.print_type_id = PTD.print_type_id AND P.print_type_id = $print_type_id//GROUP BY//    AD.attributes_id";                                $sql = "SELECT p.printing_id,p.print_type_id,p.attributes_id,p.price,pd.print_type_name,ad.attributes_name FROM printing p , print_type_description pd , attributes_description ad WHERE p.print_type_id = $print_type_id AND p.print_type_id = pd.print_type_id AND p.attributes_id = ad.attributes_id";        $query = $this->db->query($sql);                    return $query->result();             }                    public                 function printing_order($data)		{		$this->db->insert('printing_order', $data);		return $this->db->insert_id();               }                                                public	function get_gift_category($language_id)		{            		//$this->db->order_by('print_type_name', 'ASC');                $this->db->select('gc.gift_category_id,gcd.gift_category_name');                $this->db->join('gift_category_description gcd','gcd.gift_category_id = gc.gift_category_id');                $this->db->where('gcd.language_id',$language_id);                $this->db->where('gc.gift_category_status',1);		$query = $this->db->get('gift_category gc');		return $query->result();                		}                                                    public function get_gift($language_id,$gift_category_id){        $sql = "SELECT g.gift_id,g.gift_category_id,g.attributes_id,g.price,gd.gift_category_name,ad.attributes_name FROM gift g , gift_category_description gd , attributes_description ad WHERE g.gift_category_id = $gift_category_id AND g.gift_category_id = gd.gift_category_id AND g.attributes_id = ad.attributes_id";        $query = $this->db->query($sql);                    return $query->result();             }                public                 function gift_order($data)     {	$this->db->insert('gift_order', $data);	return $this->db->insert_id();     }                public	function get_government_paper_category($language_id)		{            		//$this->db->order_by('print_type_name', 'ASC');                $this->db->select('gp.government_paper_category_id,gpd.government_paper_category_name');                $this->db->join('government_paper_category_description gpd','gpd.government_paper_category_id = gp.government_paper_category_id');                $this->db->where('gpd.language_id',$language_id);                $this->db->where('gp.government_paper_category_status',1);		$query = $this->db->get('government_paper_category gp');		return $query->result();                               }                        public             function get_government_papers($language_id,$government_paper_category_id){        $sql = "SELECT g.government_paper_id,g.government_paper_category_id,g.price,gd.government_paper_title,gd.government_paper_description FROM government_paper g , government_paper_description gd  WHERE g.government_paper_category_id = $government_paper_category_id AND g.government_paper_id = gd.government_paper_id";        $query = $this->db->query($sql);                    return $query->result();                      }                                      public                function government_papers_order($data)     {	$this->db->insert('government_paper_order',$data);	return $this->db->insert_id();     }               public                   function get_photo_printing($language_id){            $sql = "SELECT p.photoprinting_id,p.attributes_id,p.price,ad.attributes_name FROM photoprinting p , attributes_description ad WHERE  p.attributes_id = ad.attributes_id";     $query = $this->db->query($sql);                 return $query->result();               }                   public                function photo_printing_order($data)     {	$this->db->insert('photo_printing_order',$data);	return $this->db->insert_id();     }                       public	function get_others($language_id)		{            		//$this->db->order_by('print_type_name', 'ASC');                $this->db->select('o.others_id,od.others_title,od.others_description,od.others_image');                $this->db->join('others_description od','od.others_id = o.others_id');                $this->db->where('od.language_id',$language_id);                $this->db->where('od.others_status',1);		$query = $this->db->get('others o');		return $query->result();                		}          }?>